version: 0.1
log:
  fields:
    service: registry
    environment: development
storage:
    cache:
        layerinfo: inmemory
    filesystem:
        rootdirectory: /opt/docker-registry
    delete:
        enabled: true
http:
    addr: :"{{ registry_host_port }}
{% if secure_registry | bool %}
    tls:
      certificate: "{{ external_registry_dir }}/{{ registry_certfile | basename}}"
      key: "{{ external_registry_dir }}/{{ registry_certkeyfile | basename }}"
{% if registry_client_cas s defined and registry_client_cas | length > 0 %}
      clientcas:
{% for cltca in registry_client_cas %}
        - "{{ external_registry_dir }}/{{ cltca }}"
{% endfor %}
    host: "https://{{ registry_host_fqdn }}:{{ registry_host_port }}"
{% endif %}
    secret: "{{ registry_secret }}" 
    relativeurls: false
{% if enable_auth_on_registry and registry_auth_dir | length > 0 %}
auth:
    htpasswd:
      realm: basic-realm
      path: "{{ registry_auth_dir }}/{{ registry_authzfile }}" 
{% endif %}
